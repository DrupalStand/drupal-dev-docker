#!/usr/bin/env bash

readonly PROGDIR="$(cd "$( dirname "${BASH_SOURCE[0]}" )" >/dev/null && pwd)"
readonly PROJECT="$(basename "$(dirname "$PROGDIR")")"
readonly PROJECT_DIR="$(dirname "$PROGDIR")"

USING_STDIN="t"

# if using stdin then we need to disable tty mode
if [ ! -t 0 ] ; then USING_STDIN=""; fi

# allow dynamic variables like columns
shopt -s checkwinsize

for PARAM in "$@"
do
  PARAMS="${PARAMS} \"${PARAM}\""
done

docker run -i$USING_STDIN \
           -e COLUMNS=$COLUMNS \
           -v "${PROJECT_DIR}:/mnt" \
           -w "/mnt" \
           --rm \
           alpine:latest sh -c "${PARAMS}"
